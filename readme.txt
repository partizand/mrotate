Log rotation for Windows

Ротация логов для Windows

Задумка

Неким образом отбирается список файлов.
Затем их 
1. переименовываем или  архивируем
3. удаляем
4. архивированные или переименованные файлы удаляем, если нужно

Список файлов можно задать
1. По дате создания: старше n дней
2. По размеру: больше n байт

Пример настроек

[Entry1]
Source=d:\temp\rotate\*.log
; Период хранения оригиналов в днях
Period=90
; Обрабатывать все файлы больше указанного размера (или этот параметр или period)
;Size=100K 
compress=7z
; Каталог старых файлов, если не указан то он Source
TargetDir=d:\temp\rotateold
; Маска наименования архивов, по умолчанию %fileName, к ней всегда добавляется расширение архиватора
;TargetMask=%FileName
; Сколько дней хранить старые файлы, аналог Period, если не указан, то вечно
KeepPeriod=180 
; Какую дату брать у файлов (по умолчанию Created)
DateMode=Modified


На будущее
sharedscripts=yes; Эти команды выполняются один раз, иначе для каждого файла
prerotate=имя команды ; Выполнить команду перед ротацией
postrotate= имя команды ; Выполнить команду после ротации

Настройки архива
[7z]
ExeName=7z.exe
Extension=.7z
; В аргументы делятся по пробелам!
Args=a %ArhFileName %FullFileName -m0=PPMd

